<!DOCTYPE html>
<html>

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <title>Mood Tracker App | Sign Up</title>
</head>

<body>
    <h1>Login to Mood Tracker App</h1>
    <div><a href="/">Home</a></div>
    <br />
    <br />
    <p>username: </p>
    <input id="username" value="username" />
    <br />
    <p>password: </p>
    <input id="password" value="password" />
    <br />
    
    <button id="submit">Login</button>

    <script>
        const button = document.getElementById('submit');
        button.addEventListener('click', async event => {
            const username = document.getElementById("username").value;
            const password = document.getElementById("password").value;
            data = {username, password}
            const options = {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify(data)
                };
            const res =  await fetch('/user/signin', options);
            const json = await res.json();
            console.log("status: ",res.status)
            if (res.status === 200){
                console.log("Status code matched!")
                window.localStorage.setItem("access_token", json.token);
                window.location.replace(json.url);
            }
            
        });
    </script>
</body>